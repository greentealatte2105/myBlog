<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Hamiltonian Circuit Problem | HuuPhuoc&#39;s Blog</title>
<meta name="keywords" content="CS112">
<meta name="description" content="Đặt vấn đề: Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:
 Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:  Đường đi $x_0, x_1, &hellip;, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,&hellip;,x_{n-1}, x_n$} với $x_i \not = x_j; 0 \leq i &lt; j \leq n.">
<meta name="author" content="Đào Trần Anh Tuấn">
<link rel="canonical" href="/posts/cs112/backtracking/hamiltionial_cycle/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.b4e19c453811e60acfec1f00c15ac2be1c53f6ab90187e684358ce7faaf48bab.css" integrity="sha256-tOGcRTgR5grP7B8AwVrCvhxT9quQGH5oQ1jOf6r0i6s=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.4dcb3c4f38462f66c6b6137227726f5543cb934cca9788f041c087e374491df2.js" integrity="sha256-Tcs8TzhGL2bGthNyJ3JvVUPLk0zKl4jwQcCH43RJHfI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" href="apple-touch-icon.png">
<link rel="mask-icon" href="safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Hamiltonian Circuit Problem" />
<meta property="og:description" content="Đặt vấn đề: Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:
 Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:  Đường đi $x_0, x_1, &hellip;, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,&hellip;,x_{n-1}, x_n$} với $x_i \not = x_j; 0 \leq i &lt; j \leq n." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/cs112/backtracking/hamiltionial_cycle/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-04-13T23:14:03&#43;07:00" />
<meta property="article:modified_time" content="2022-04-13T23:14:03&#43;07:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Hamiltonian Circuit Problem"/>
<meta name="twitter:description" content="Đặt vấn đề: Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:
 Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:  Đường đi $x_0, x_1, &hellip;, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,&hellip;,x_{n-1}, x_n$} với $x_i \not = x_j; 0 \leq i &lt; j \leq n."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Hamiltonian Circuit Problem",
      "item": "/posts/cs112/backtracking/hamiltionial_cycle/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Hamiltonian Circuit Problem",
  "name": "Hamiltonian Circuit Problem",
  "description": "Đặt vấn đề: Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:\n Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:  Đường đi $x_0, x_1, \u0026hellip;, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,\u0026hellip;,x_{n-1}, x_n$} với $x_i \\not = x_j; 0 \\leq i \u0026lt; j \\leq n.",
  "keywords": [
    "CS112"
  ],
  "articleBody": "Đặt vấn đề: Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:\n Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:  Đường đi $x_0, x_1, …, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,…,x_{n-1}, x_n$} với $x_i \\not = x_j; 0 \\leq i Chu trình $x_0, x_1,…, x_{n-1}, x_n$ là chu trình Hamilton nếu $x_0, x_1,…, x_{n-1}, x_n$ là đường đi Hamilton.   Hiểu đơn giản chu trình Hamilton là đường đi xuất phát từ một đỉnh, đi qua mọi đỉnh của đồ thị, mỗi đỉnh đúng một lần và kết thúc tại đỉnh bắt đầu.  Ví Dụ: Với đồ thị sau:\nTa có thể tìm ra một chu trình Hamilton là: $a \\to b \\to f \\to e \\to c \\to d \\to a.$\n Input: là một ma trận kề 2 chiều $n \\times n$  $\\begin{bmatrix} 0 \u0026 1 \u0026 1 \u0026 1 \u0026 0 \u0026 0 \\\\ 1 \u0026 0 \u0026 1 \u0026 0 \u0026 0 \u0026 1 \\\\ 1 \u0026 1 \u0026 0 \u0026 1 \u0026 1 \u0026 0 \\\\ 1 \u0026 0 \u0026 1 \u0026 0 \u0026 1 \u0026 0 \\\\ 0 \u0026 0 \u0026 1 \u0026 1 \u0026 0 \u0026 1 \\\\ 0 \u0026 1 \u0026 0 \u0026 0 \u0026 1 \u0026 0 \\\\ \\end{bmatrix}$\n Output: là một chu trình Hamilton (nếu có):  $\\begin{bmatrix} 0 \u0026 1 \u0026 5 \u0026 4 \u0026 2 \u0026 3 \u0026 0 \\end{bmatrix}$\nHướng tiếp cận:  Sử dụng thuật toán quay lui (backtracking) với ý tưởng của thuật toán duyệt theo chiều sâu (DFS). Ta sẽ tiến hành duyệt qua đồ thị cho đến khi tất cả mọi đỉnh được thăm:  Bước 1: Bắt đầu duyệt đồ thị xuất phát tại một đỉnh bất kì để thăm các đỉnh kề. Bước 2: Tại mỗi lần thăm ta sẽ quay ngược về đỉnh trước đó để tìm đường khác nếu đỉnh hiện tại không thể đi qua đỉnh kề nó (tức là các đỉnh lận cận đã được thăm trước đó). Bước 3: Nếu chúng ta quay về được đỉnh xuất phát sau khi thăm tất cả các đỉnh của đồ thị thì đó là một chu trình Hamilton của đồ thị, ngược lại thì không tồn tại chu trình Hamilton. Lưu ý: cần phải đánh dấu mỗi đỉnh đã được thăm để không thể thăm đỉnh đó quá 1 lần.   Minh họa quá trình giải bài toán bằng giải thuật quay lui sử dụng state-space tree:  Pseudo-Code: Giải thuật bằng mã giả, sử dụng 2 hàm chính:\n Function:  isValid(v, k) Input: Đỉnh $v$ và vị trí $k$. Output: Kiểm tra liệu đặt đỉnh $v$ tại vị trí $k$ có thỏa hay không.   Begin\rif there is no edge between node(k-1) to v, then\rreturn false\rif v is already taken, then\rreturn false\rreturn true; // otherwise it is valid\rEnd  Function:  cycleFound(node k) Input: node của đồ thị. Output: return true khi có chu trình Hamilton, ngược lại return false.   Begin\rif all nodes are included, then\rif there is an edge between nodes k and 0, then\rreturn true\relse\rreturn false for all vertex v except starting point, do\rif isValid(v, k), then //when v is a valid edge\radd v into the path\rif cycleFound(k+1) is true, then\rreturn true\rotherwise remove v from the path\rdone\rreturn false End ",
  "wordCount" : "593",
  "inLanguage": "en",
  "datePublished": "2022-04-13T23:14:03+07:00",
  "dateModified": "2022-04-13T23:14:03+07:00",
  "author":{
    "@type": "Person",
    "name": "Đào Trần Anh Tuấn"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/posts/cs112/backtracking/hamiltionial_cycle/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "HuuPhuoc's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "favicon.ico"
    }
  }
}
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js" onload="renderMathInElement(document.body);"></script>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>

</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="" accesskey="h" title="HuuPhuoc&#39;s Blog (Alt + H)">HuuPhuoc&#39;s Blog</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="/categories/" title="Categories">
                    <span>Categories</span>
                </a>
            </li>
            <li>
                <a href="/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
            <li>
                <a href="/archives/" title="Archives">
                    <span>Archives</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="">Home</a>&nbsp;»&nbsp;<a href="/posts/">Posts</a></div>
    <h1 class="post-title">
      Hamiltonian Circuit Problem
    </h1>
    <div class="post-meta"><span title='2022-04-13 23:14:03 +0700 +07'>April 13, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;Đào Trần Anh Tuấn

</div>
  </header> 
  <div class="post-content"><h2 id="đặt-vấn-đề">Đặt vấn đề:<a hidden class="anchor" aria-hidden="true" href="#đặt-vấn-đề">#</a></h2>
<p>Chu trình Hamilton là một dạng bài toán phổ biến trong bài toán đồ thị. Vậy chu trình Hamilton là gì? Bắt đầu với định nghĩa sau:</p>
<ul>
<li>Cho đồ thị $G = $ { $V$, $E$ }$ $ có $V$ là tập đỉnh, $E$ là tập cạnh, gồm $n$ đỉnh:
<ul>
<li>Đường đi $x_0, x_1, &hellip;, x_{n-1}, x_{n}$ gọi là đường đi Hamilton nếu: $V$ = {$x_0, x_1,&hellip;,x_{n-1}, x_n$} với $x_i \not = x_j; 0 \leq i &lt; j \leq n.$</li>
<li>Chu trình $x_0, x_1,&hellip;, x_{n-1}, x_n$ là chu trình Hamilton nếu $x_0, x_1,&hellip;, x_{n-1}, x_n$ là đường đi Hamilton.</li>
</ul>
</li>
<li>Hiểu đơn giản chu trình Hamilton là đường đi xuất phát từ một đỉnh, đi qua mọi đỉnh của đồ thị, mỗi đỉnh đúng một lần và kết thúc tại đỉnh bắt đầu.</li>
</ul>
<h3 id="ví-dụ">Ví Dụ:<a hidden class="anchor" aria-hidden="true" href="#ví-dụ">#</a></h3>
<p>Với đồ thị sau:</p>
<p><img loading="lazy" src="/images/CompletedSearch-Backtracking/HamiltonianCycle/dothihamilton1.png" alt="đồ thị 1"  />
</p>
<p>Ta có thể tìm ra một chu trình Hamilton là: $a \to b \to f \to e \to c \to d \to a.$</p>
<p><img loading="lazy" src="/images/CompletedSearch-Backtracking/HamiltonianCycle/dothihamilton2.png" alt="đồ thị 2"  />
</p>
<ul>
<li><strong>Input:</strong> là một <a href="https://vi.wikipedia.org/wiki/Ma_tr%E1%BA%ADn_k%E1%BB%81">ma trận kề</a> 2 chiều $n \times n$</li>
</ul>
<p>$\begin{bmatrix}
0 &amp; 1 &amp; 1 &amp; 1 &amp; 0 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 \\
1 &amp; 1 &amp; 0 &amp; 1 &amp; 1 &amp; 0 \\
1 &amp; 0 &amp; 1 &amp; 0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; 1 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 \\
\end{bmatrix}$</p>
<ul>
<li><strong>Output:</strong> là một chu trình Hamilton (nếu có):</li>
</ul>
<p>$\begin{bmatrix}
0 &amp; 1 &amp; 5 &amp; 4 &amp; 2 &amp; 3 &amp; 0
\end{bmatrix}$</p>
<h3 id="hướng-tiếp-cận">Hướng tiếp cận:<a hidden class="anchor" aria-hidden="true" href="#hướng-tiếp-cận">#</a></h3>
<ul>
<li>Sử dụng thuật toán quay lui (backtracking) với ý tưởng của thuật toán duyệt theo chiều sâu (DFS). Ta sẽ tiến hành duyệt qua đồ thị cho đến khi tất cả mọi đỉnh được thăm:
<ul>
<li>Bước 1: Bắt đầu duyệt đồ thị xuất phát tại một đỉnh bất kì để thăm các đỉnh kề.</li>
<li>Bước 2: Tại mỗi lần thăm ta sẽ quay ngược về đỉnh trước đó để tìm đường khác nếu đỉnh hiện tại không thể đi qua đỉnh kề nó (tức là các đỉnh lận cận đã được thăm trước đó).</li>
<li>Bước 3: Nếu chúng ta quay về được đỉnh xuất phát sau khi thăm tất cả các đỉnh của đồ thị thì đó là một chu trình Hamilton của đồ thị, ngược lại thì không tồn tại chu trình Hamilton. Lưu ý: cần phải đánh dấu mỗi đỉnh đã được thăm để không thể thăm đỉnh đó quá 1 lần.</li>
</ul>
</li>
<li>Minh họa quá trình giải bài toán bằng giải thuật quay lui sử dụng state-space tree:</li>
</ul>
<p><img loading="lazy" src="/images/CompletedSearch-Backtracking/HamiltonianCycle/state-space-tree.png" alt="state-space-tree"  />
</p>
<h3 id="pseudo-code">Pseudo-Code:<a hidden class="anchor" aria-hidden="true" href="#pseudo-code">#</a></h3>
<p>Giải thuật bằng mã giả, sử dụng 2 hàm chính:</p>
<ul>
<li>Function: <code> isValid(v, k)</code></li>
<li>Input: Đỉnh $v$ và vị trí $k$.</li>
<li>Output: Kiểm tra liệu đặt đỉnh $v$ tại vị trí $k$ có thỏa hay không.</li>
</ul>
<pre tabindex="0"><code>    Begin
        if there is no edge between node(k-1) to v, then
            return false
        if v is already taken, then
            return false
        return true; // otherwise it is valid
    End
</code></pre><ul>
<li>Function: <code> cycleFound(node k)</code></li>
<li>Input: node của đồ thị.</li>
<li>Output: return true khi có chu trình Hamilton, ngược lại return false.</li>
</ul>
<pre tabindex="0"><code>    Begin
        if all nodes are included, then
            if there is an edge between nodes k and 0, then
                return true
            else
                return false  
        for all vertex v except starting point, do
            if isValid(v, k), then //when v is a valid edge
                add v into the path
                if cycleFound(k+1) is true, then
                    return true
                otherwise remove v from the path
        done
        return false  
    End
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="/tags/cs112/">CS112</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="/posts/cs112/backtracking/subsetsum/">
    <span class="title">« Prev Page</span>
    <br>
    <span>Subset-Sum Problem</span>
  </a>
  <a class="next" href="/posts/cs112/backtracking/n-queenproblem/">
    <span class="title">Next Page »</span>
    <br>
    <span>N-queen Problem</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="">HuuPhuoc&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
